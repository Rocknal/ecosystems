<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Checklist Auditor√≠a | EcoSystems</title>
<link rel="stylesheet" th:href="@{/css/checklist.css}">
</head>
<body>

	<div class="checklist-container">

		<form class="checklist-card" th:action="@{/guardar-auditoria}"
			th:object="${auditoria}" method="post">

			<input type="hidden" th:name="${_csrf.parameterName}"
				th:value="${_csrf.token}" /> <input type="hidden"
				name="usuarioEmail" th:value="${#authentication.name}">

			<!-- HEADER -->
			<div class="checklist-header">
				<div class="logo-circle">üåø</div>
				<h1>CHECK LIST AUDITOR√çA</h1>
				<p>Auditor√≠a Interna SIGASS</p>

				<div class="header-fields">
					<div>
						<label>C√≥digo</label> <input type="text" th:field="*{codigo}"
							placeholder="Ingrese c√≥digo">
						<div class="error" th:if="${#fields.hasErrors('codigo')}"
							th:errors="*{codigo}"></div>
					</div>

					<div>
						<label>Revisi√≥n</label> <input type="text" name="revision"
							value="00">
					</div>
				</div>
			</div>

			<!-- DATOS DEL PROPONENTE -->
			<div class="section-box">

				<h2>Datos del Proponente</h2>

				<label>Silo de Acopio</label> <input type="text"
					th:field="*{siloAcopio}">
				<div class="error" th:if="${#fields.hasErrors('siloAcopio')}"
					th:errors="*{siloAcopio}"></div>

				<div class="grid-3">
					<div>
						<label>Departamento</label> <select id="departamento"
							th:field="*{departamento}">
							<option value="">Seleccione departamento</option>
						</select>
						<div class="error" th:if="${#fields.hasErrors('departamento')}"
							th:errors="*{departamento}"></div>
					</div>

					<div>
						<label>Distrito</label> <select id="distrito"
							th:field="*{distrito}" disabled>
							<option value="">Seleccione distrito</option>
						</select>
						<div class="error" th:if="${#fields.hasErrors('distrito')}"
							th:errors="*{distrito}"></div>
					</div>

					<div>
						<label>Localidad</label> <input type="text"
							th:field="*{localidad}">
					</div>
				</div>

				<label>Lugar</label> <input type="text" th:field="*{lugar}">

				<div class="grid-2">
					<div>
						<label>Coordenadas X</label> <input type="text"
							th:field="*{coordenadaX}">
					</div>
					<div>
						<label>Coordenadas Y</label> <input type="text"
							th:field="*{coordenadaY}">
					</div>
				</div>

			</div>


			<!-- LEYENDA -->
			<div class="legend">
				<strong>Leyenda:</strong> <span><b>C</b>: Cumple</span> <span><b>NC</b>:
					No Cumple</span> <span><b>N/A</b>: No Aplica</span> <span><b>O/M</b>:
					Observaci√≥n / Mejora</span>
			</div>

			<div th:each="item, iterStat : ${auditoria.items}">

				<!-- Mostrar t√≠tulo cuando cambia la secci√≥n -->
				<div
					th:if="${iterStat.index == 0 or 
                 item.checklistItem.seccion != 
                 auditoria.items[iterStat.index - 1].checklistItem.seccion}">

					<h2
						th:text="${item.checklistItem.seccion} + '. ' + 
                     ${nombresSecciones[item.checklistItem.seccion]}">
					</h2>
				</div>

				<div class="check-row">

					<span th:text="${item.checklistItem.descripcion}"></span> <input
						type="hidden"
						th:field="*{items[__${iterStat.index}__].checklistItem.id}" />

					<div class="options">
						<label> <input type="radio"
							th:field="*{items[__${iterStat.index}__].resultado}" value="C">
							C
						</label> <label> <input type="radio"
							th:field="*{items[__${iterStat.index}__].resultado}" value="NC">
							NC
						</label> <label> <input type="radio"
							th:field="*{items[__${iterStat.index}__].resultado}" value="NA">
							N/A
						</label> <label> <input type="radio"
							th:field="*{items[__${iterStat.index}__].resultado}" value="OM">
							O/M
						</label>
					</div>
				</div>

			</div>

			<label>Observaciones Generales</label>
			<textarea rows="4" th:field="*{observaciones}"></textarea>

			<button type="submit" class="btn-save">Guardar Auditor√≠a</button>

		</form>

		<a href="/home" class="back-link">‚Üê Volver al Home</a>

	</div>

	<script>
	const dataParaguay = {
			  "Alto Paraguay": [
			    "Bah√≠a Negra",
			    "Carmelo Peralta",
			    "Fuerte Olimpo"
			  ],

			  "Alto Paran√°": [
			    "Ciudad del Este",
			    "Doctor Juan Le√≥n Mallorqu√≠n",
			    "Hernandarias",
			    "Iru√±a",
			    "Itakyry",
			    "Juan E. O'Leary",
			    "Los Cedrales",
			    "Mbaracay√∫",
			    "Minga Guaz√∫",
			    "Presidente Franco",
			    "San Alberto",
			    "San Crist√≥bal",
			    "Santa Fe del Paran√°",
			    "Santa Rita",
			    "Santa Rosa del Monday",
			    "Tavapy",
			    "Yguaz√∫"
			  ],

			  "Amambay": [
			    "Pedro Juan Caballero",
			    "Bella Vista Norte",
			    "Capit√°n Bado",
			    "Karapa√≠",
			    "Zanja Pyt√£"
			  ],

			  "Boquer√≥n": [
			    "Filadelfia",
			    "Loma Plata",
			    "Mariscal Estigarribia"
			  ],

			  "Caaguaz√∫": [
			    "Coronel Oviedo",
			    "Caaguaz√∫",
			    "Caraya√≥",
			    "Doctor Cecilio B√°ez",
			    "Jos√© Domingo Ocampos",
			    "La Pastora",
			    "Mcal. Francisco S. L√≥pez",
			    "Nueva Londres",
			    "Repatriaci√≥n",
			    "R.I. 3 Corrales",
			    "San Joaqu√≠n",
			    "San Jos√© de los Arroyos",
			    "Sim√≥n Bol√≠var",
			    "Tembiapor√£",
			    "Tres Corrales",
			    "Vaquer√≠a",
			    "Yh√∫"
			  ],

			  "Caazap√°": [
			    "Caazap√°",
			    "Aba√≠",
			    "Buena Vista",
			    "Doctor Mois√©s Bertoni",
			    "Fulgencio Yegros",
			    "General Higinio Mor√≠nigo",
			    "Maciel",
			    "San Juan Nepomuceno",
			    "Tava√≠",
			    "Yuty"
			  ],

			  "Canindey√∫": [
			    "Salto del Guair√°",
			    "Corpus Christi",
			    "Curuguaty",
			    "General Francisco Caballero √Ålvarez",
			    "Itanar√°",
			    "Katuet√©",
			    "La Paloma",
			    "Nueva Esperanza",
			    "Yasy Ca√±y",
			    "Ybyraroban√°",
			    "Ypejh√∫"
			  ],

			  "Central": [
			    "Aregu√°",
			    "Capiat√°",
			    "Fernando de la Mora",
			    "Guarambar√©",
			    "It√°",
			    "Itaugu√°",
			    "J. Augusto Sald√≠var",
			    "Lambar√©",
			    "Limpio",
			    "Luque",
			    "Mariano Roque Alonso",
			    "√ëemby",
			    "Nueva Italia",
			    "San Antonio",
			    "San Lorenzo",
			    "Villa Elisa",
			    "Villeta",
			    "Ypacara√≠",
			    "Ypan√©"
			  ],

			  "Concepci√≥n": [
			    "Concepci√≥n",
			    "Bel√©n",
			    "Horqueta",
			    "Loreto",
			    "San Carlos del Apa",
			    "San L√°zaro",
			    "Yby Ya√∫"
			  ],

			  "Cordillera": [
			    "Caacup√©",
			    "Altos",
			    "Arroyos y Esteros",
			    "Atyr√°",
			    "Caraguatay",
			    "Emboscada",
			    "Eusebio Ayala",
			    "Isla Puc√∫",
			    "Itacurub√≠ de la Cordillera",
			    "Juan de Mena",
			    "Loma Grande",
			    "Mbocayaty del Yhaguy",
			    "Nueva Colombia",
			    "Piribebuy",
			    "Primero de Marzo",
			    "San Bernardino",
			    "Santa Elena",
			    "Tobat√≠",
			    "Valenzuela"
			  ],

			  "Guair√°": [
			    "Villarrica",
			    "Borja",
			    "Capit√°n Mauricio Jos√© Troche",
			    "Coronel Mart√≠nez",
			    "Dr. Bottrell",
			    "F√©lix P√©rez Cardozo",
			    "Independencia",
			    "Itap√©",
			    "Iturbe",
			    "Jos√© Fassardi",
			    "Mbocayaty",
			    "Natalicio Talavera",
			    "√ëum√≠",
			    "Paso Yob√°i",
			    "San Salvador",
			    "Yataity"
			  ],

			  "Itap√∫a": [
			    "Encarnaci√≥n",
			    "Alto Ver√°",
			    "Bella Vista",
			    "Cambyret√°",
			    "Capit√°n Meza",
			    "Capit√°n Miranda",
			    "Carlos Antonio L√≥pez",
			    "Carmen del Paran√°",
			    "Coronel Bogado",
			    "Edelira",
			    "Fram",
			    "General Artigas",
			    "General Delgado",
			    "Hohenau",
			    "Jes√∫s",
			    "La Paz",
			    "Leandro Oviedo",
			    "Mayor Ota√±o",
			    "Natalio",
			    "Nueva Alborada",
			    "Obligado",
			    "Pirap√≥",
			    "San Cosme y Dami√°n",
			    "San Juan del Paran√°",
			    "San Pedro del Paran√°",
			    "Trinidad",
			    "Yatytay"
			  ],

			  "Misiones": [
			    "San Juan Bautista",
			    "Ayolas",
			    "San Ignacio",
			    "San Miguel",
			    "San Patricio",
			    "Santa Mar√≠a",
			    "Santa Rosa",
			    "Santiago",
			    "Villa Florida",
			    "Yabebyry"
			  ],

			  "√ëeembuc√∫": [
			    "Pilar",
			    "Alberdi",
			    "Cerrito",
			    "Desmochados",
			    "Guaz√∫ Cu√°",
			    "Humait√°",
			    "Isla Umb√∫",
			    "Laureles",
			    "Mayor Mart√≠nez",
			    "Paso de Patria",
			    "San Juan Bautista del √ëeembuc√∫",
			    "Tacuaras",
			    "Villa Franca",
			    "Villa Oliva"
			  ],

			  "Paraguar√≠": [
			    "Paraguar√≠",
			    "Acahay",
			    "Caapuc√∫",
			    "Carapegu√°",
			    "Escobar",
			    "General Bernardino Caballero",
			    "La Colmena",
			    "Mbuyapey",
			    "Piray√∫",
			    "Quiindy",
			    "Quyquyh√≥",
			    "San Roque Gonz√°lez",
			    "Sapucai",
			    "Tebicuarym√≠",
			    "Yaguar√≥n",
			    "Ybycu√≠",
			    "Ybytym√≠"
			  ],

			  "Presidente Hayes": [
			    "Villa Hayes",
			    "Benjam√≠n Aceval",
			    "Nanawa",
			    "Puerto Pinasco",
			    "Teniente Esteban Mart√≠nez"
			  ],

			  "San Pedro": [
			    "San Pedro del Ycuamandyy√∫",
			    "Antequera",
			    "Capiibary",
			    "Chor√©",
			    "General Elizardo Aquino",
			    "General Resqu√≠n",
			    "Guayaib√≠",
			    "Itacurub√≠ del Rosario",
			    "Liberaci√≥n",
			    "Lima",
			    "Nueva Germania",
			    "San Estanislao",
			    "San Pablo",
			    "Santa Rosa del Aguaray",
			    "Tacuat√≠",
			    "Uni√≥n",
			    "Villa del Rosario",
			    "Yataity del Norte"
			  ]
			};

const deptoSelect = document.getElementById("departamento");
const distritoSelect = document.getElementById("distrito");

// Cargar departamentos
Object.keys(dataParaguay).forEach(depto => {
    const option = document.createElement("option");
    option.value = depto;
    option.textContent = depto;
    deptoSelect.appendChild(option);
});

// Cambio de departamento
deptoSelect.addEventListener("change", () => {
    const selectedDepto = deptoSelect.value;

    distritoSelect.innerHTML = '<option value="">Seleccione distrito</option>';
    distritoSelect.disabled = true;

    if (selectedDepto && dataParaguay[selectedDepto]) {
        dataParaguay[selectedDepto].forEach(distrito => {
            const option = document.createElement("option");
            option.value = distrito;
            option.textContent = distrito;
            distritoSelect.appendChild(option);
        });
        distritoSelect.disabled = false;
    }
});
</script>


</body>
</html>
